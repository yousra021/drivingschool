{% extends "base.html" %}

{% block title %}Planning g√©n√©ral{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto p-6 bg-white shadow-lg rounded-lg">

    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">üìÖ Planning g√©n√©ral</h2>

    <!-- Filtrage par moniteur -->
    <form method="get" class="mb-6 flex justify-center">
        <div class="flex items-center space-x-4">
            <label for="instructor" class="text-lg text-gray-700">Filtrer par moniteur :</label>
            <select name="instructor" id="instructor" onchange="this.form.submit()" class="px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400">
                <option value="">-- Tous --</option>
                {% for instructor in instructors %}
                    <option value="{{ instructor.id }}" {% if instructor.id == selected_instructor_id %}selected{% endif %}>
                        {{ instructor.get_full_name|default:instructor.username }}
                    </option>
                {% endfor %}
            </select>
        </div>
    </form>

    <!-- Table of appointments -->
    <table class="min-w-full table-auto mt-6 border-separate border-spacing-0.5">
        <thead>
            <tr class="bg-indigo-500 text-white">
                <th class="px-4 py-2 text-left">Date</th>
                <th class="px-4 py-2 text-left">Heure</th>
                <th class="px-4 py-2 text-left">√âl√®ve</th>
                <th class="px-4 py-2 text-left">Moniteur</th>
                <th class="px-4 py-2 text-left">Lieu</th>
                <th class="px-4 py-2 text-left">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for appointment in appointments %}
                <tr class="bg-gray-50 hover:bg-gray-100">
                    <td class="px-4 py-2">{{ appointment.date|date:"d/m/Y" }}</td>
                    <td class="px-4 py-2">{{ appointment.time|time:"H:i" }}</td>
                    <td class="px-4 py-2">{{ appointment.student.get_full_name|default:appointment.student.username }}</td>
                    <td class="px-4 py-2">{{ appointment.instructor.get_full_name|default:appointment.instructor.username }}</td>
                    <td class="px-4 py-2">{{ appointment.location }}</td>
                    <td class="px-4 py-2 text-blue-500">
                        <a href="{% url 'appointment_update' appointment.id %}" class="hover:underline">‚úèÔ∏è Modifier</a> |
                        <a href="{% url 'appointment_delete' appointment.id %}" class="text-red-500 hover:underline">‚ùå Supprimer</a>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="6" class="text-center text-gray-500">Aucun rendez-vous.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

</div>
{% endblock %}
